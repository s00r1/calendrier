<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calendrier du ménage de la cuisine</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <button id="langSwitcher" class="lang-switcher" title="Changer de langue">AR</button>
    <button id="themeSwitcher" class="theme-switcher" title="Changer de thème">🌘</button>
    <h1>Calendrier du ménage de la cuisine</h1>
    <h2 id="subtitle"></h2>
    <div class="controls">
        <div class="date-selectors">
            <select id="month"></select>
            <select id="year"></select>
        </div>
        <button id="admin-login">Admin</button>
    </div>

    <div class="admin-section">
        <h3 id="config-title" class="admin-section-title">🛠️ Gestion de la configuration</h3>
        <div class="card">
            <div class="config-controls">
                <select id="config-select"></select>
                <button id="load-config" title="Charger la config"><span class="icon">📂</span> Load</button>
                <button id="save-config" title="Enregistrer la config"><span class="icon">💾</span> Save</button>
                <button id="delete-config" title="Supprimer la config"><span class="icon">🗑️</span> Del</button>
                <button id="change-pass" title="Changer le mot de passe"><span class="icon">🔑</span> Passwd</button>
            </div>
        </div>
        <h3 id="rooms-title" class="admin-section-title">🏠 Chambres & Départs</h3>
        <div class="card">
            <div class="admin-group">
                <label for="start-room">No de chambre de départ</label>
                <select id="start-room"></select>
                <label for="start-day">Jour de début</label>
                <select id="start-day"></select>
            </div>
        </div>
        <h3 id="exclusions-title" class="admin-section-title">🚫 Exclusions</h3>
        <div class="card">
            <div class="admin-group">
                <label for="exclude-room">Exclure :</label>
                <select id="exclude-room"></select>
                <button id="add-exclude" title="Ajouter à la liste des exclusions">➕</button>
                <div id="excluded-list"></div>
            </div>
        </div>
        <h3 id="linked-rooms-title" class="admin-section-title">🔗 Chambres liées</h3>
        <div class="card">
            <div class="admin-group" id="link-group">
                <select id="link-room-a"></select>
                <select id="link-room-b"></select>
                <button id="add-link" title="Lier les chambres">🔗 Lier</button>
                <div id="linked-list"></div>
            </div>
        </div>
        <div class="admin-buttons card" style="margin-bottom: 0;">
            <button id="auto-assign" title="Affectation automatique"><span class="icon">🤖</span> Auto</button>
            <button id="clear-calendar" title="Vider le calendrier"><span class="icon">🧹</span> Vider</button>
        </div>
        <div id="error-message" class="error-message"></div>
    </div>

    
    <div id="calendar" class="calendar"></div>
    <button id="print">Imprimer</button>
    <div id="logout-modal" class="modal">
        <div class="modal-content">
            <p>Quitter le mode admin ?</p>
            <div class="modal-buttons">
                <button id="logout-confirm">Oui</button>
                <button id="logout-cancel">Non</button>
            </div>
        </div>
    </div>
    <template id="room-input-template">
        <div class="room-input">
            <span class="room-prefix"></span>
            <input type="text" min="1" max="54" placeholder="#">
            <button type="button" class="add-room">+</button>
        </div>
    </template>
    <!-- Chargement des modules en ES modules -->
    <script src="env-loader.js"></script>
    <script type="module" src="src/calendar.js"></script>
    <script>
      (function() {
        const params = new URLSearchParams(window.location.search);
        if (params.has('test-api')) {
          const s = document.createElement('script');
          s.type = 'module';
          s.src = 'test-api.js';
          document.head.appendChild(s);
        }
      })();
    </script>
</body>
</html>
