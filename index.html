<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calendrier du ménage de la cuisine</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <button id="langSwitcher" class="lang-switcher" title="Changer de langue">AR</button>
    <button id="themeSwitcher" class="theme-switcher" title="Changer de thème">🌘</button>
    <h1>Calendrier du ménage de la cuisine</h1>
    <h2 id="subtitle"></h2>
    <div class="controls">
        <div class="date-selectors">
            <select id="month"></select>
            <select id="year"></select>
        </div>
        <button id="admin-login">Admin</button>
    </div>

    <div class="admin-section">
        <h3 id="auto-options-title"></h3>
        <div id="admin-controls" class="admin-controls">
            <div class="config-controls">
                <select id="config-select"></select>
                <button id="load-config">📂 Load</button>
                <button id="save-config">💾 Save</button>
                <button id="delete-config">🗑️ Del</button>
                <button id="change-pass">🔑 Passwd</button>
            </div>

            <div class="admin-group">
                <label for="start-room">No de chambre de départ</label>
                <select id="start-room"></select>
                <label for="start-day">Jour de début</label>
                <select id="start-day"></select>
            </div>
            <div class="admin-group">
                <label for="exclude-room">Exclure&nbsp;:</label>
                <select id="exclude-room"></select>
                <button id="add-exclude">+</button>
                <div id="excluded-list"></div>
            </div>
            <p id="linked-rooms-title">Chambres liées</p>
            <div class="admin-group" id="link-group">
                <select id="link-room-a"></select>
                <select id="link-room-b"></select>
                <button id="add-link">Lier</button>
                <div id="linked-list"></div>
            </div>
            <div class="admin-buttons">
                <button id="auto-assign">Auto</button>
                <button id="clear-calendar">Vider</button>
            </div>
        </div>
        <div id="error-message" class="error-message"></div>
    </div>
    <div id="calendar" class="calendar"></div>
    <button id="download-pdf">Télécharger PDF</button>
    <button id="print">Imprimer</button>
    <div id="logout-modal" class="modal">
        <div class="modal-content">
            <p>Quitter le mode admin ?</p>
            <div class="modal-buttons">
                <button id="logout-confirm">Oui</button>
                <button id="logout-cancel">Non</button>
            </div>
        </div>
    </div>
    <template id="room-input-template">
        <div class="room-input">
            <span class="room-prefix"></span>
            <input type="text" min="1" max="54" placeholder="#">
            <button type="button" class="add-room">+</button>
        </div>
    </template>
    <!-- Chargement des modules en ES modules -->
    <script src="env-loader.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script type="module" src="src/calendar.js"></script>
    <script>
      (function() {
        const params = new URLSearchParams(window.location.search);
        if (params.has('test-api')) {
          const s = document.createElement('script');
          s.type = 'module';
          s.src = 'test-api.js';
          document.head.appendChild(s);
        }
      })();
    </script>
</body>
</html>
